/*
 * HTML5 audio alert library with flash-fallback.
 *
 * Copyright (c) 2010 Jess Thrysoee, http://thrysoee.dk
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
var AudioAlert=(function(){var a=function(b){if("Audio" in window){return new a.prototype.html5(b)}else{return new a.prototype.flash(b)}};a.prototype={html5:function(b){var c,d;d=this.options=b;c=this.audio=new Audio();if(d.loadeddata){c.addEventListener("loadeddata",d.loadeddata,false)}if(d.ended){c.addEventListener("ended",d.ended,false)}if(d.error){c.addEventListener("error",d.error,false)}c.src=c.canPlayType("audio/mpeg")?d.mp3:d.ogg},flash:function(c){var d,b=this;this.options=c;this.flashReady=false;this.swfobjectReady=false;this.pendingPlay=false;this.id="audioalert"+(a.id++);a.add(this.id,this);swfobject.addDomLoadEvent(function(){b.init()})}};a.prototype.html5.prototype={play:function(){if(this.audio.readyState!=4){this.audio.autoplay=true}this.audio.play()},bind:function(b,c){this.options[b]=c;this.audio.addEventListener(b,c,false)}};a.prototype.flash.prototype={init:function(){var d,c,e,b;b=this;e=this.options;c=document.createElement("div");c.style.cssText="position:fixed; left=0; bottom=0; width=8px; height=8px; overflow:hidden";d=document.createElement("div");d.id=this.id;c.appendChild(d);document.body.appendChild(c);swfobject.embedSWF(e.swf||"audioalert-1.3.swf",this.id,"8","8","9.0.0",null,{mp3:e.mp3},{allowscriptaccess:"always"},{name:this.id},function(f){b.audio=f.ref;b.swfobjectReady=true;if(b.pendingPlay&&b.flashReady){b.play()}})},play:function(){if(this.flashReady&&this.swfobjectReady){this.pendingPlay=false;this.audio.audioAlertPlay()}else{this.pendingPlay=true}},bind:function(b,c){this.options[b]=c}};(function(){a.id=1;a.instances={};a.add=function(c,b){a.instances[c]=b};a.get=function(b){return a.instances[b]};a.onLoadedData=function(c){var b=this.get(c);if(b){if(b.options.loadeddata){b.options.loadeddata()}b.flashReady=true;if(b.pendingPlay&&b.swfobjectReady){b.play()}}};a.onError=function(d,c){var b=this.get(d);if(b&&b.options.error){b.options.error(c)}};a.onEnded=function(c){var b=this.get(c);if(b&&b.options.ended){b.options.ended()}}}());return(window.AudioAlert=a)}());